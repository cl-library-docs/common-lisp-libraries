<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>cl-who - DSL for Markup - common-lisp-libraries</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  <link href="../extra.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "cl-who - DSL for Markup";
    var mkdocs_page_input_path = "cl-who.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/lisp.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> common-lisp-libraries</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">index</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Defacto libraries</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../asdf/">asdf - Build System</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../alexandria/">alexandria - Commonly Used Utilities</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../bordeaux-threads/">bordeaux-threads - Threading</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../cl-ppcre/">cl-ppcre - Regular Expressions</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">cl-who - DSL for Markup</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#getting-started">GETTING STARTED</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#configuration-variables">CONFIGURATION VARIABLES</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#attribute-quote-char">*attribute-quote-char*</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#downcase-tokens-p">*downcase-tokens-p*</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#empty-attribute-syntax">*empty-attribute-syntax*</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#escape-char-p">*escape-char-p*</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#html-empty-tag-aware-p">*html-empty-tag-aware-p*</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#html-empty-tags">*html-empty-tags*</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#html-no-indent-tags">*html-no-indent-tags*</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#prologue">*prologue*</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#functions-and-macros">FUNCTIONS AND MACROS</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#conc">conc</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#convert-attributes">convert-attributes</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#convert-tag-to-string-list">convert-tag-to-string-list</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#esc">esc</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#escape-char">escape-char</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#escape-char-all">escape-char-all</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#escape-char-iso-8859-1">escape-char-iso-8859-1</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#escape-char-minimal">escape-char-minimal</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#escape-char-minimal-plus-quotes">escape-char-minimal-plus-quotes</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#escape-string">escape-string</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#escape-string-all">escape-string-all</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#escape-string-iso-8859-1">escape-string-iso-8859-1</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#escape-string-minimal">escape-string-minimal</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#escape-string-minimal-plus-quotes">escape-string-minimal-plus-quotes</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#fmt">fmt</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#htm">htm</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#html-mode">html-mode</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#str">str</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#with-html-output">with-html-output</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#with-html-output-to-string">with-html-output-to-string</a>
    </li>
        </ul>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../fiveam/">fiveam - Regression Testing Framework</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../hunchentoot/">hunchentoot - Web Server</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../iterate/">iterate - Psuedocodic Iteration</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../local-time/">local-time - Date and Time Manipulation</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../postmodern/">postmodern - PostgreSQL programming interace</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../quicklisp/">quicklisp - Library Manager</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../usocket/">usocket - Universal Socket Library</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../utilities/">utilities - A collection of utility libraries</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Not yet defacto</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../numcl/">numcl - Lispy clone of numpy</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../unix-opts/">unix-opts - cmd line argument parser</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">common-lisp-libraries</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Defacto libraries &raquo;</li>
        
      
    
    <li>cl-who - DSL for Markup</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="cl-who-dsl-for-markup">cl-who - DSL for Markup</h1>
<p>Version: 1.1.4
<br/>
Nickname: who
<br/>
Licence: BSD
<br/>
Repository: <a href="https://github.com/edicl/cl-who">edicl/cl-who - Github</a>
<br>
See also: <a href="https://github.com/CodyReichert/awesome-cl#html-generators-and-templates">awesome-cl#html-generators-and-templates</a></p>
<p><em>This documentation is possible due to the  <a href="https://edicl.github.io/cl-who">excellent official documentation</a> as of 5th May 2020.</em></p>
<p><em>In case of any inaccuracies, ambiguities or suggestions, please <a href="https://github.com/cl-library-docs/common-lisp-libraries/issues">create an issue here</a>.</em></p>
<hr />
<p>CL-WHO primarily provides a single macro <a href="#with-html-output">with-html-output</a> to convert S-expressions intermingled with code into
(X)HTML, XML and the likes.</p>
<h2 id="getting-started">GETTING STARTED</h2>
<p><a href="#with-html-output">with-html-output</a> and <a href="#with-html-output-to-string">with-html-output-to-string</a>
are the basic macros to get going:</p>
<pre><code class="language-lisp">CL-USER&gt; (defparameter *site-alist*
           '((&quot;http://zappa.com/&quot; . &quot;Frank Zappa&quot;)
             (&quot;http://marcusmiller.com/&quot; . &quot;Marcus Miller&quot;)
             (&quot;http://www.milesdavis.com/&quot; . &quot;Miles Davis&quot;)))
*SITE-ALIST*

CL-USER&gt; (format t
                 (with-html-output-to-string (s nil :indent t)
                   (loop for (link . title) in *site-alist*
                      do (htm (:a :href link
                                  (:b (str title))) ; &lt;- note the str!
                              :br))))

&lt;a href='http://zappa.com/'&gt;
  &lt;b&gt;Frank Zappa
  &lt;/b&gt;
&lt;/a&gt;
&lt;br /&gt;
&lt;a href='http://marcusmiller.com/'&gt;
  &lt;b&gt;Marcus Miller
  &lt;/b&gt;
&lt;/a&gt;
&lt;br /&gt;
&lt;a href='http://www.milesdavis.com/'&gt;
  &lt;b&gt;Miles Davis
  &lt;/b&gt;
&lt;/a&gt;
&lt;br /&gt;
NIL

CL-USER&gt; (format t
                 (with-output-to-string (s)
                   (with-html-output (s s :indent t)
                     (loop for (link . title) in *site-alist*
                        do (htm (:a :href link
                                    (:b (str title))) ; &lt;- note the str!
                                :br)))))

&lt;a href='http://zappa.com/'&gt;
  &lt;b&gt;Frank Zappa
  &lt;/b&gt;
&lt;/a&gt;
&lt;br /&gt;
&lt;a href='http://marcusmiller.com/'&gt;
  &lt;b&gt;Marcus Miller
  &lt;/b&gt;
&lt;/a&gt;
&lt;br /&gt;
&lt;a href='http://www.milesdavis.com/'&gt;
  &lt;b&gt;Miles Davis
  &lt;/b&gt;
&lt;/a&gt;
&lt;br /&gt;
</code></pre>
<p>Inside these macros, there exist the lexically scoped macros: </p>
<ul>
<li><strong>esc</strong> as short-hand for <a href="#escape-string">escape-string</a></li>
<li><strong>fmt</strong> as short-hand for <a href="http://www.lispworks.com/documentation/lw50/CLHS/Body/f_format.htm">cl:format</a></li>
<li><strong>htm</strong> as short-hand for (another) <code>with-html-output</code>.</li>
<li><strong>str</strong> as short-hand for, well, writing to the "inner html" rather than attributes; 
basically the difference between these two:</li>
</ul>
<pre><code class="language-lisp">CL-USER&gt; (let ((string &quot;hello&quot;)
               (class &quot;world&quot;))
           (with-html-output-to-string (s nil :indent t)
             (htm (:div :class class string))))
&quot;
&lt;div class='world'&gt;
&lt;/div&gt;&quot;
CL-USER&gt; (let ((string &quot;hello&quot;)
               (class &quot;world&quot;))
           (with-html-output-to-string (s nil :indent t)
             (htm (:div :class class (str string)))))
&quot;
&lt;div class='world'&gt;hello
&lt;/div&gt;&quot;
</code></pre>
<p>In this case, <code>str</code> could equivalently be replaced by <code>fmt</code> or <code>esc</code>.</p>
<p>Also see <a href="#html-mode">html-mode</a>. Detailed transformation rules are available in 
the <a href="https://edicl.github.io/cl-who/#syntax">official documentation</a>.</p>
<h2 id="configuration-variables">CONFIGURATION VARIABLES</h2>
<h3 id="attribute-quote-char">*attribute-quote-char*</h3>
<pre><code class="language-lisp">Variable
</code></pre>
<p>Quote character for attributes.</p>
<h3 id="downcase-tokens-p">*downcase-tokens-p*</h3>
<pre><code class="language-lisp">Variable
</code></pre>
<p>If NIL, a keyword symbol representing a tag or attribute name will
not be automatically converted to lowercase.  If T, the tag and
attribute name will be converted to lowercase only if it is in the
same case. This is useful when one needs to output case sensitive
XML.</p>
<h3 id="empty-attribute-syntax">*empty-attribute-syntax*</h3>
<pre><code class="language-lisp">Variable
</code></pre>
<p>Set this to <code>t</code> to enable attribute minimization (also called
"boolean attributes", or "empty attribute syntax" according to the <a href="https://www.w3.org/TR/2012/WD-html-markup-20120329/syntax.html#syntax-attr-empty">w3
html standard</a>). In XHTML attribute minimization is forbidden, and all
attributes must have a value. Thus in XHTML boolean attributes must be
defined as &lt;input disabled='disabled' />. In HTML5 boolean attributes
can be defined as &lt;input disabled></p>
<p>If it is NIL the attribute will be left out completely.</p>
<pre><code>(:td :nowrap nil) =&gt; &quot;&lt;td /&gt;&quot;
</code></pre>
<h3 id="escape-char-p">*escape-char-p*</h3>
<pre><code class="language-lisp">Variable
</code></pre>
<p>Used by <a href="#escape-string">escape-string</a> to test whether a character should be escaped.</p>
<h3 id="html-empty-tag-aware-p">*html-empty-tag-aware-p*</h3>
<pre><code class="language-lisp">Variable
</code></pre>
<p>Set this to NIL to if you want to use CL-WHO as a strict XML
generator.  Otherwise, CL-WHO will only write empty tags listed
in <a href="#html-empty-tags">*html-empty-tags*</a> as &lt;tag/> (XHTML mode) or &lt;tag> (SGML
mode and HTML5 mode).  For all other tags, it will always generate
&lt;tag>&lt;/tag>.</p>
<h3 id="html-empty-tags">*html-empty-tags*</h3>
<pre><code class="language-lisp">Variable
</code></pre>
<p>The list of HTML tags that should be output as empty tags.
See <a href="#html-empty-tag-aware-p">*html-empty-tag-aware-p*</a>.</p>
<h3 id="html-no-indent-tags">*html-no-indent-tags*</h3>
<pre><code class="language-lisp">Variable
</code></pre>
<p>The list of HTML tags that should disable indentation inside them. The initial
value is a list containing only <code>:pre</code> and <code>:textarea</code>.</p>
<h3 id="prologue">*prologue*</h3>
<pre><code class="language-lisp">Variable
</code></pre>
<p>This is the first line that'll be printed if the <code>:prologue</code> keyword
argument is T</p>
<h2 id="functions-and-macros">FUNCTIONS AND MACROS</h2>
<h3 id="conc">conc</h3>
<pre><code class="language-lisp">Function: (conc &amp;rest string-list)
</code></pre>
<p>Concatenates all arguments which should be string into one string.</p>
<h3 id="convert-attributes">convert-attributes</h3>
<pre><code class="language-lisp">Function: (convert-attributes attr-list)
</code></pre>
<p>Helper function for <a href="#convert-tag-to-string-list">convert-tag-to-string-list</a> which converts the
alist <code>attr-list</code> of attributes into a list of strings and/or Lisp
forms.</p>
<h3 id="convert-tag-to-string-list">convert-tag-to-string-list</h3>
<pre><code class="language-lisp">Generic Function: (convert-tag-to-string-list tag attr-list body body-fn)
</code></pre>
<p>Used by <code>cl-who::process-tag</code> to convert <code>HTML</code> into a list
of strings.  <code>tag</code> is a keyword symbol naming the outer tag, <code>attr-list</code>
is an alist of its attributes (the car is the attribute's name as a
keyword, the cdr is its value), <code>body</code> is the tag's body, and <code>body-fn</code> is
a function which should be applied to <code>body</code>.  The function must return
a list of strings or Lisp forms.</p>
<h3 id="esc">esc</h3>
<h3 id="escape-char">escape-char</h3>
<pre><code class="language-lisp">Function: (escape-char char &amp;key (test *escape-char-p*))
</code></pre>
<p>Returns an escaped version of the character <code>char</code> if <code>char</code> satisfies
the predicate <code>test</code>.  Always returns a string.</p>
<h3 id="escape-char-all">escape-char-all</h3>
<pre><code class="language-lisp">Function: (escape-char-all char)
</code></pre>
<p>Escapes characters which aren't in the 7-bit ASCII character set.</p>
<h3 id="escape-char-iso-8859-1">escape-char-iso-8859-1</h3>
<pre><code class="language-lisp">Function: (escape-char-iso-8859-1 char)
</code></pre>
<p>Escapes characters that aren't defined in ISO-8859-9.</p>
<h3 id="escape-char-minimal">escape-char-minimal</h3>
<pre><code class="language-lisp">Function: (escape-char-minimal char)
</code></pre>
<p>Escapes only #&lt;, #&gt;, and #&amp; characters.</p>
<h3 id="escape-char-minimal-plus-quotes">escape-char-minimal-plus-quotes</h3>
<pre><code class="language-lisp">Function: (escape-char-minimal-plus-quotes char)
</code></pre>
<p>Like <a href="#escape-char-minimal">escape-char-minimal</a> but also escapes quotes.</p>
<h3 id="escape-string">escape-string</h3>
<pre><code class="language-lisp">Function: (escape-string string &amp;key (test *escape-char-p*))
</code></pre>
<p>Escape all characters in <code>string</code> which pass <code>test</code>. This function is
not guaranteed to return a fresh string.  Note that you can pass NIL
for <code>string</code> which'll just be returned.</p>
<h3 id="escape-string-all">escape-string-all</h3>
<pre><code class="language-lisp">Function: (escape-string-all string)
</code></pre>
<p>Escapes all characters in <code>string</code> which aren't in the 7-bit ASCII
character set.</p>
<h3 id="escape-string-iso-8859-1">escape-string-iso-8859-1</h3>
<pre><code class="language-lisp">Function: (escape-string-iso-8859-1 string)
</code></pre>
<p>Escapes all characters in <code>string</code> which aren't defined in ISO-8859-1.</p>
<h3 id="escape-string-minimal">escape-string-minimal</h3>
<pre><code class="language-lisp">Function: (escape-string-minimal string)
</code></pre>
<p>Escapes only #&lt;, #&gt;, and #&amp; in <code>string</code>.</p>
<h3 id="escape-string-minimal-plus-quotes">escape-string-minimal-plus-quotes</h3>
<pre><code class="language-lisp">Function: (escape-string-minimal-plus-quotes string)
</code></pre>
<p>Like <a href="#escape-string-minimal">escape-string-minimal</a> but also escapes quotes.</p>
<h3 id="fmt">fmt</h3>
<h3 id="htm">htm</h3>
<h3 id="html-mode">html-mode</h3>
<pre><code class="language-lisp">Function: (html-mode)
</code></pre>
<p>Returns the current HTML mode. :SGML for (SGML-)HTML, :XML for
XHTML and :HTML5 for HTML5 (HTML syntax).</p>
<pre><code class="language-lisp">Function: (setf (html-mode) mode)
</code></pre>
<p>Sets the output mode to XHTML or (SGML-)HTML.  MODE can be
:SGML for HTML, :XML for XHTML or :HTML5 for HTML5 (HTML syntax).</p>
<h3 id="str">str</h3>
<h3 id="with-html-output">with-html-output</h3>
<pre><code class="language-lisp">Macro: (with-html-output (var &amp;optional stream &amp;rest rest &amp;key prologue indent) &amp;body body)
</code></pre>
<p>Transform the enclosed <code>body</code> consisting of HTML as s-expressions
into Lisp code to write the corresponding HTML as strings to <code>var</code> -
which should either hold a stream or which'll be bound to STREAM if
supplied.</p>
<h3 id="with-html-output-to-string">with-html-output-to-string</h3>
<pre><code class="language-lisp">Macro: (with-html-output-to-string (var &amp;optional string-form &amp;key prologue
                                    indent) &amp;body body)
</code></pre>
<p>Transform the enclosed <code>body</code> consisting of HTML as s-expressions
into Lisp code which creates the corresponding HTML as a string.</p>
              
            </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../cl-ppcre/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../fiveam/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(false);
        };
    </script>

</body>
</html>
